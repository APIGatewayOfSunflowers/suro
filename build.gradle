ext.githubProjectName = rootProject.name

buildscript {
    repositories {
        mavenLocal()
        mavenCentral() // maven { url 'http://jcenter.bintray.com' }
    }
    apply from: file('gradle/buildscript.gradle'), to: buildscript 
}

allprojects {
    repositories { 
      mavenCentral()
      maven{
        name 'github.release.repo'
        url 'https://raw.github.com/bulldog2011/bulldog-repo/master/repo/releases/'
      }
    }
}

apply from: file('gradle/convention.gradle')
apply from: file('gradle/maven.gradle')
apply from: file('gradle/check.gradle')
apply from: file('gradle/license.gradle')
apply from: file('gradle/release.gradle')


subprojects {
    apply plugin: 'java'
    apply plugin: 'idea'
    apply plugin: 'project-report'

    group = "com.netflix.${githubProjectName}"

    configurations {
      all*.exclude group: 'org.codehaus.jackson', module: 'jackson-mapper'
      all*.exclude group: 'org.codehaus.jackson', module: 'jackson-core'
      all*.exclude group: 'javax.servlet', module: 'servlet-api'
    }

    dependencies {
        compile 'com.netflix.archaius:archaius-core:0.5.6'
        compile 'com.netflix.servo:servo-core:0.4.32'
        compile 'com.netflix.governator:governator:1.1.1'
        compile 'com.netflix.eureka:eureka-client:1.1.73'
        compile 'com.netflix.ribbon:ribbon-core:0.1.5'
        compile 'com.netflix.ribbon:ribbon-eureka:0.1.5'
        compile 'log4j:log4j:1.2.17'

        compile 'org.apache.thrift:libthrift:0.7.0'
        compile 'org.slf4j:slf4j-api:1.6.4'
        compile 'com.google.guava:guava:11.0.2'
        compile 'joda-time:joda-time:2.1'
        compile 'com.fasterxml.jackson.core:jackson-databind:2.1.4'
        compile 'com.fasterxml.jackson.core:jackson-annotations:2.1.4'
        compile 'com.fasterxml.jackson.core:jackson-core:2.1.4'
        compile 'com.fasterxml.jackson.datatype:jackson-datatype-guava:2.2.0'

        compile 'com.ning:compress-lzf:0.9.5'
        compile 'com.leansoft:bigqueue:0.7.0'
        compile 'commons-io:commons-io:2.4'

        compile (
            [group: 'org.apache.hadoop', name: 'hadoop-core', version: '1.1.2', transitive: false]
        )

        testCompile 'org.mockito:mockito-core:1.9.5'
        testCompile 'junit:junit:4.+'
    }

  test {
    forkEvery = 1
    maxParallelForks = 1
  }
}

project(':suro-client') {
}

project(':suro-server') {
    dependencies {
        compile project(':suro-client')
        compile 'net.java.dev.jets3t:jets3t:0.9.0'

        compile 'org.eclipse.jetty:jetty-servlet:9.0.0.v20130308'
        compile 'com.sun.jersey.contribs:jersey-guice:1.17.1'
        compile 'com.sun.jersey:jersey-server:1.17.1'

        compile 'commons-cli:commons-cli:1.2'

        testCompile project(':suro-client').sourceSets.test.output
    }
}

project(':suro-integration-test') {
  dependencies {
    testCompile project(':suro-client')
    testCompile project(':suro-server')
    testCompile project(':suro-client').sourceSets.test.output
    testCompile project(':suro-server').sourceSets.test.output
  }
}

